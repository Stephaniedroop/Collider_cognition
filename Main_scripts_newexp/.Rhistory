}
plot3 <- plot_nomodel_pgroup('A=.1,Au=.7,B=.8,Bu=.5', df)
print(plot3)
str(df)
df <- read.csv('../model_data/fit16mpn.csv') # 288 obs of 28
df$structure <- ifelse(substr(df$trial_id, 3, 3) == "c", "conjunctive",
ifelse(substr(df$trial_id, 3, 3) == "d", "disjunctive", NA))
df$trial_type <- recode(df$trial_id,
"1_c1"="A=0,B=0,E=0",
"1_c2"="A=0,B=1,E=0",
"1_c3"="A=1,B=0,E=0",
"1_c4"="A=1,B=1,E=0",
"1_c5"="A=1,B=1,E=1",
"1_d1"="A=0,B=0,E=0",
"1_d2"="A=0,B=1,E=0",
"1_d3"="A=0,B=1,E=1",
"1_d4"="A=1,B=0,E=0",
"1_d5"="A=1,B=0,E=1",
"1_d6"="A=1,B=1,E=0",
"1_d7"="A=1,B=1,E=1",
"2_c1"="A=0,B=0,E=0",
"2_c2"="A=0,B=1,E=0",
"2_c3"="A=1,B=0,E=0",
"2_c4"="A=1,B=1,E=0",
"2_c5"="A=1,B=1,E=1",
"2_d1"="A=0,B=0,E=0",
"2_d2"="A=0,B=1,E=0",
"2_d3"="A=0,B=1,E=1",
"2_d4"="A=1,B=0,E=0",
"2_d5"="A=1,B=0,E=1",
"2_d6"="A=1,B=1,E=0",
"2_d7"="A=1,B=1,E=1",
"3_c1"="A=0,B=0,E=0",
"3_c2"="A=0,B=1,E=0",
"3_c3"="A=1,B=0,E=0",
"3_c4"="A=1,B=1,E=0",
"3_c5"="A=1,B=1,E=1",
"3_d1"="A=0,B=0,E=0",
"3_d2"="A=0,B=1,E=0",
"3_d3"="A=0,B=1,E=1",
"3_d4"="A=1,B=0,E=0",
"3_d5"="A=1,B=0,E=1",
"3_d6"="A=1,B=1,E=0",
"3_d7"="A=1,B=1,E=1")
df$trial_structure_type <- recode(df$trial_id,
"1_c1"="Conjunctive: A=0,B=0,E=0",
"1_c2"="Conjunctive: A=0,B=1,E=0",
"1_c3"="Conjunctive: A=1,B=0,E=0",
"1_c4"="Conjunctive: A=1,B=1,E=0",
"1_c5"="Conjunctive: A=1,B=1,E=1",
"1_d1"="Disjunctive: A=0,B=0,E=0",
"1_d2"="Disjunctive: A=0,B=1,E=0",
"1_d3"="Disjunctive: A=0,B=1,E=1",
"1_d4"="Disjunctive: A=1,B=0,E=0",
"1_d5"="Disjunctive: A=1,B=0,E=1",
"1_d6"="Disjunctive: A=1,B=1,E=0",
"1_d7"="Disjunctive: A=1,B=1,E=1",
"2_c1"="Conjunctive: A=0,B=0,E=0",
"2_c2"="Conjunctive: A=0,B=1,E=0",
"2_c3"="Conjunctive: A=1,B=0,E=0",
"2_c4"="Conjunctive: A=1,B=1,E=0",
"2_c5"="Conjunctive: A=1,B=1,E=1",
"2_d1"="Disjunctive: A=0,B=0,E=0",
"2_d2"="Disjunctive: A=0,B=1,E=0",
"2_d3"="Disjunctive: A=0,B=1,E=1",
"2_d4"="Disjunctive: A=1,B=0,E=0",
"2_d5"="Disjunctive: A=1,B=0,E=1",
"2_d6"="Disjunctive: A=1,B=1,E=0",
"2_d7"="Disjunctive: A=1,B=1,E=1",
"3_c1"="Conjunctive: A=0,B=0,E=0",
"3_c2"="Conjunctive: A=0,B=1,E=0",
"3_c3"="Conjunctive: A=1,B=0,E=0",
"3_c4"="Conjunctive: A=1,B=1,E=0",
"3_c5"="Conjunctive: A=1,B=1,E=1",
"3_d1"="Disjunctive: A=0,B=0,E=0",
"3_d2"="Disjunctive: A=0,B=1,E=0",
"3_d3"="Disjunctive: A=0,B=1,E=1",
"3_d4"="Disjunctive: A=1,B=0,E=0",
"3_d5"="Disjunctive: A=1,B=0,E=1",
"3_d6"="Disjunctive: A=1,B=1,E=0",
"3_d7"="Disjunctive: A=1,B=1,E=1")
df<- df %>% mutate(trial_type = factor(trial_type, levels = c("A=0,B=0,E=0",
"A=0,B=1,E=0",
"A=0,B=1,E=1",
"A=1,B=0,E=0",
"A=1,B=0,E=1",
"A=1,B=1,E=0",
"A=1,B=1,E=1")),
trial_structure_type = factor(trial_structure_type, levels = c("Conjunctive: A=1,B=1,E=1",
"Conjunctive: A=1,B=1,E=0",
"Conjunctive: A=1,B=0,E=0",
"Conjunctive: A=0,B=1,E=0",
"Conjunctive: A=0,B=0,E=0",
"Disjunctive: A=0,B=1,E=0",
"Disjunctive: A=1,B=1,E=1",
"Disjunctive: A=1,B=0,E=1",
"Disjunctive: A=0,B=1,E=1",
"Disjunctive: A=1,B=1,E=0",
"Disjunctive: A=1,B=0,E=0",
"Disjunctive: A=0,B=0,E=0")),
# NOTE THESE (ABOVE) LOOK IN THE WRONG ORDER BUT ITS JUST FOR THE PLOT
pgroup = factor(pgroup, levels = 1:3, labels = c('A=.1,Au=.5,B=.8,Bu=.5',
'A=.5,Au=.1,B=.5,Bu=.8',
'A=.1,Au=.7,B=.8,Bu=.5')),
Response = factor(node3),
Observed = factor(!Response%in%c('Au=0','Au=1','Bu=0', 'Bu=1'), levels = c(T,F)),
Variable = factor(substr(node3, 1, 1)),
#State = factor(rep(c(0,1), 144)),
Actual = factor(Actual, levels = c(FALSE, TRUE), labels = c('FALSE', 'TRUE')))
df$structure <- ifelse(substr(df$trial_id, 3, 3) == "c", "conjunctive",
ifelse(substr(df$trial_id, 3, 3) == "d", "disjunctive", NA))
df$trial_type <- recode(df$trial_id,
"1_c1"="A=0,B=0,E=0",
"1_c2"="A=0,B=1,E=0",
"1_c3"="A=1,B=0,E=0",
"1_c4"="A=1,B=1,E=0",
"1_c5"="A=1,B=1,E=1",
"1_d1"="A=0,B=0,E=0",
"1_d2"="A=0,B=1,E=0",
"1_d3"="A=0,B=1,E=1",
"1_d4"="A=1,B=0,E=0",
"1_d5"="A=1,B=0,E=1",
"1_d6"="A=1,B=1,E=0",
"1_d7"="A=1,B=1,E=1",
"2_c1"="A=0,B=0,E=0",
"2_c2"="A=0,B=1,E=0",
"2_c3"="A=1,B=0,E=0",
"2_c4"="A=1,B=1,E=0",
"2_c5"="A=1,B=1,E=1",
"2_d1"="A=0,B=0,E=0",
"2_d2"="A=0,B=1,E=0",
"2_d3"="A=0,B=1,E=1",
"2_d4"="A=1,B=0,E=0",
"2_d5"="A=1,B=0,E=1",
"2_d6"="A=1,B=1,E=0",
"2_d7"="A=1,B=1,E=1",
"3_c1"="A=0,B=0,E=0",
"3_c2"="A=0,B=1,E=0",
"3_c3"="A=1,B=0,E=0",
"3_c4"="A=1,B=1,E=0",
"3_c5"="A=1,B=1,E=1",
"3_d1"="A=0,B=0,E=0",
"3_d2"="A=0,B=1,E=0",
"3_d3"="A=0,B=1,E=1",
"3_d4"="A=1,B=0,E=0",
"3_d5"="A=1,B=0,E=1",
"3_d6"="A=1,B=1,E=0",
"3_d7"="A=1,B=1,E=1")
df$trial_structure_type <- recode(df$trial_id,
"1_c1"="Conjunctive: A=0,B=0,E=0",
"1_c2"="Conjunctive: A=0,B=1,E=0",
"1_c3"="Conjunctive: A=1,B=0,E=0",
"1_c4"="Conjunctive: A=1,B=1,E=0",
"1_c5"="Conjunctive: A=1,B=1,E=1",
"1_d1"="Disjunctive: A=0,B=0,E=0",
"1_d2"="Disjunctive: A=0,B=1,E=0",
"1_d3"="Disjunctive: A=0,B=1,E=1",
"1_d4"="Disjunctive: A=1,B=0,E=0",
"1_d5"="Disjunctive: A=1,B=0,E=1",
"1_d6"="Disjunctive: A=1,B=1,E=0",
"1_d7"="Disjunctive: A=1,B=1,E=1",
"2_c1"="Conjunctive: A=0,B=0,E=0",
"2_c2"="Conjunctive: A=0,B=1,E=0",
"2_c3"="Conjunctive: A=1,B=0,E=0",
"2_c4"="Conjunctive: A=1,B=1,E=0",
"2_c5"="Conjunctive: A=1,B=1,E=1",
"2_d1"="Disjunctive: A=0,B=0,E=0",
"2_d2"="Disjunctive: A=0,B=1,E=0",
"2_d3"="Disjunctive: A=0,B=1,E=1",
"2_d4"="Disjunctive: A=1,B=0,E=0",
"2_d5"="Disjunctive: A=1,B=0,E=1",
"2_d6"="Disjunctive: A=1,B=1,E=0",
"2_d7"="Disjunctive: A=1,B=1,E=1",
"3_c1"="Conjunctive: A=0,B=0,E=0",
"3_c2"="Conjunctive: A=0,B=1,E=0",
"3_c3"="Conjunctive: A=1,B=0,E=0",
"3_c4"="Conjunctive: A=1,B=1,E=0",
"3_c5"="Conjunctive: A=1,B=1,E=1",
"3_d1"="Disjunctive: A=0,B=0,E=0",
"3_d2"="Disjunctive: A=0,B=1,E=0",
"3_d3"="Disjunctive: A=0,B=1,E=1",
"3_d4"="Disjunctive: A=1,B=0,E=0",
"3_d5"="Disjunctive: A=1,B=0,E=1",
"3_d6"="Disjunctive: A=1,B=1,E=0",
"3_d7"="Disjunctive: A=1,B=1,E=1")
df<- df %>% mutate(trial_type = factor(trial_type, levels = c("A=0,B=0,E=0",
"A=0,B=1,E=0",
"A=0,B=1,E=1",
"A=1,B=0,E=0",
"A=1,B=0,E=1",
"A=1,B=1,E=0",
"A=1,B=1,E=1")),
trial_structure_type = factor(trial_structure_type, levels = c("Conjunctive: A=1,B=1,E=1",
"Conjunctive: A=1,B=1,E=0",
"Conjunctive: A=1,B=0,E=0",
"Conjunctive: A=0,B=1,E=0",
"Conjunctive: A=0,B=0,E=0",
"Disjunctive: A=0,B=1,E=0",
"Disjunctive: A=1,B=1,E=1",
"Disjunctive: A=1,B=0,E=1",
"Disjunctive: A=0,B=1,E=1",
"Disjunctive: A=1,B=1,E=0",
"Disjunctive: A=1,B=0,E=0",
"Disjunctive: A=0,B=0,E=0")),
# NOTE THESE (ABOVE) LOOK IN THE WRONG ORDER BUT ITS JUST FOR THE PLOT
pgroup = factor(pgroup, levels = 1:3, labels = c('A=.1,Au=.5,B=.8,Bu=.5',
'A=.5,Au=.1,B=.5,Bu=.8',
'A=.1,Au=.7,B=.8,Bu=.5')),
Response = factor(node3),
Observed = factor(!Response%in%c('Au=0','Au=1','Bu=0', 'Bu=1'), levels = c(T,F)),
Variable = factor(substr(node3, 1, 1)),
#State = factor(rep(c(0,1), 144)),
Actual = factor(Actual, levels = c(FALSE, TRUE), labels = c('FALSE', 'TRUE')))
df$SE <- NA
# Need to add SE
for (i in unique(df$trial_id))
{
df$SE[df$trial_id==i]<-sqrt((df$prop[df$trial_id==i] * (1-df$prop[df$trial_id==i])) / sum(df$n[df$trial_id==i]))
}
df$Actual[is.na(df$Actual)] <- FALSE
saveRDS(df, file = "../model_data/fitforplot16mpn.RDS")
write.csv(df, '../model_data/fitforplot16mpn.csv')
# Sometims just for running
df <- read.RDS("../model_data/fitforplot16mpn.csv", stringsAsFactors = T)
# Sometims just for running
df <- readRDS("../model_data/fitforplot16mpn.csv", stringsAsFactors = T)
# Sometims just for running
df <- readRDS("../model_data/fitforplot16mpn.csv")
# Sometims just for running
df <- readRDS("../model_data/fitforplot16mpn.RDS")
# Define plotting function
plot_nomodel_pgroup <- function(pgroup_label, df) {
df_filtered <- df %>% filter(pgroup == pgroup_label)
ggplot(df_filtered, aes(x = node3, y = prop, fill = Observed, colour = Actual)) +
geom_bar(stat = 'identity') +
geom_errorbar(aes(ymin = prop-SE, ymax = prop+SE), width = .2) +
labs(
x = 'Response',
y = 'Proportion/',
title = sprintf("Particpant responses at %s", pgroup_label)
) +
scale_fill_brewer(palette = "Set2") + # , labels = c("Observed \n(A|B)", "Unobserved \n(Au|Bu)")
scale_colour_manual(values = c('gray', 'black')) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
#geom_point(aes(y = .data[[model_colname]]), colour = 'black') +
geom_rect(
data = subset(df_filtered, trial_structure_type %in% c("Conjunctive: A=1,B=1,E=1", "Disjunctive: A=1,B=1,E=1")),
fill = NA, colour = "blue", xmin = -Inf, xmax = Inf, linewidth = 2,
ymin = -Inf, ymax = Inf
) +
facet_wrap(~trial_structure_type, ncol = 6) +
theme_bw() +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.margin = margin(c(0, 0, 0, 0)),
axis.title.x = element_text(margin = margin(t = 1, r = 0, b = 0, l = 0)),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
}
plot3 <- plot_nomodel_pgroup('A=.1,Au=.7,B=.8,Bu=.5', df)
print(plot3)
str(df)
df <- read.csv('../model_data/fit16mpn.csv') # 288 obs of 28
df$structure <- ifelse(substr(df$trial_id, 3, 3) == "c", "conjunctive",
ifelse(substr(df$trial_id, 3, 3) == "d", "disjunctive", NA))
df$trial_type <- recode(df$trial_id,
"1_c1"="A=0,B=0,E=0",
"1_c2"="A=0,B=1,E=0",
"1_c3"="A=1,B=0,E=0",
"1_c4"="A=1,B=1,E=0",
"1_c5"="A=1,B=1,E=1",
"1_d1"="A=0,B=0,E=0",
"1_d2"="A=0,B=1,E=0",
"1_d3"="A=0,B=1,E=1",
"1_d4"="A=1,B=0,E=0",
"1_d5"="A=1,B=0,E=1",
"1_d6"="A=1,B=1,E=0",
"1_d7"="A=1,B=1,E=1",
"2_c1"="A=0,B=0,E=0",
"2_c2"="A=0,B=1,E=0",
"2_c3"="A=1,B=0,E=0",
"2_c4"="A=1,B=1,E=0",
"2_c5"="A=1,B=1,E=1",
"2_d1"="A=0,B=0,E=0",
"2_d2"="A=0,B=1,E=0",
"2_d3"="A=0,B=1,E=1",
"2_d4"="A=1,B=0,E=0",
"2_d5"="A=1,B=0,E=1",
"2_d6"="A=1,B=1,E=0",
"2_d7"="A=1,B=1,E=1",
"3_c1"="A=0,B=0,E=0",
"3_c2"="A=0,B=1,E=0",
"3_c3"="A=1,B=0,E=0",
"3_c4"="A=1,B=1,E=0",
"3_c5"="A=1,B=1,E=1",
"3_d1"="A=0,B=0,E=0",
"3_d2"="A=0,B=1,E=0",
"3_d3"="A=0,B=1,E=1",
"3_d4"="A=1,B=0,E=0",
"3_d5"="A=1,B=0,E=1",
"3_d6"="A=1,B=1,E=0",
"3_d7"="A=1,B=1,E=1")
df$trial_structure_type <- recode(df$trial_id,
"1_c1"="Conjunctive: A=0,B=0,E=0",
"1_c2"="Conjunctive: A=0,B=1,E=0",
"1_c3"="Conjunctive: A=1,B=0,E=0",
"1_c4"="Conjunctive: A=1,B=1,E=0",
"1_c5"="Conjunctive: A=1,B=1,E=1",
"1_d1"="Disjunctive: A=0,B=0,E=0",
"1_d2"="Disjunctive: A=0,B=1,E=0",
"1_d3"="Disjunctive: A=0,B=1,E=1",
"1_d4"="Disjunctive: A=1,B=0,E=0",
"1_d5"="Disjunctive: A=1,B=0,E=1",
"1_d6"="Disjunctive: A=1,B=1,E=0",
"1_d7"="Disjunctive: A=1,B=1,E=1",
"2_c1"="Conjunctive: A=0,B=0,E=0",
"2_c2"="Conjunctive: A=0,B=1,E=0",
"2_c3"="Conjunctive: A=1,B=0,E=0",
"2_c4"="Conjunctive: A=1,B=1,E=0",
"2_c5"="Conjunctive: A=1,B=1,E=1",
"2_d1"="Disjunctive: A=0,B=0,E=0",
"2_d2"="Disjunctive: A=0,B=1,E=0",
"2_d3"="Disjunctive: A=0,B=1,E=1",
"2_d4"="Disjunctive: A=1,B=0,E=0",
"2_d5"="Disjunctive: A=1,B=0,E=1",
"2_d6"="Disjunctive: A=1,B=1,E=0",
"2_d7"="Disjunctive: A=1,B=1,E=1",
"3_c1"="Conjunctive: A=0,B=0,E=0",
"3_c2"="Conjunctive: A=0,B=1,E=0",
"3_c3"="Conjunctive: A=1,B=0,E=0",
"3_c4"="Conjunctive: A=1,B=1,E=0",
"3_c5"="Conjunctive: A=1,B=1,E=1",
"3_d1"="Disjunctive: A=0,B=0,E=0",
"3_d2"="Disjunctive: A=0,B=1,E=0",
"3_d3"="Disjunctive: A=0,B=1,E=1",
"3_d4"="Disjunctive: A=1,B=0,E=0",
"3_d5"="Disjunctive: A=1,B=0,E=1",
"3_d6"="Disjunctive: A=1,B=1,E=0",
"3_d7"="Disjunctive: A=1,B=1,E=1")
df<- df %>% mutate(trial_type = factor(trial_type, levels = c("A=0,B=0,E=0",
"A=0,B=1,E=0",
"A=0,B=1,E=1",
"A=1,B=0,E=0",
"A=1,B=0,E=1",
"A=1,B=1,E=0",
"A=1,B=1,E=1")),
trial_structure_type = factor(trial_structure_type, levels = c("Conjunctive: A=1,B=1,E=1",
"Conjunctive: A=1,B=1,E=0",
"Conjunctive: A=1,B=0,E=0",
"Conjunctive: A=0,B=1,E=0",
"Conjunctive: A=0,B=0,E=0",
"Disjunctive: A=0,B=1,E=0",
"Disjunctive: A=1,B=1,E=1",
"Disjunctive: A=1,B=0,E=1",
"Disjunctive: A=0,B=1,E=1",
"Disjunctive: A=1,B=1,E=0",
"Disjunctive: A=1,B=0,E=0",
"Disjunctive: A=0,B=0,E=0")),
# NOTE THESE (ABOVE) LOOK IN THE WRONG ORDER BUT ITS JUST FOR THE PLOT
pgroup = factor(pgroup, levels = 1:3, labels = c('A=.1,Au=.5,B=.8,Bu=.5',
'A=.5,Au=.1,B=.5,Bu=.8',
'A=.1,Au=.7,B=.8,Bu=.5')),
Response = factor(node3),
Observed = factor(!Response%in%c('Au=0','Au=1','Bu=0', 'Bu=1'), levels = c(T,F)),
Variable = factor(substr(node3, 1, 1)),
#State = factor(rep(c(0,1), 144)),
Actual = factor(Actual, levels = c(FALSE, TRUE), labels = c('FALSE', 'TRUE')))
df$trial_id <- as.factor(df$trial_id)
df$node3 <- as.factor(df$node3)
df$SE <- NA
# Need to add SE
for (i in unique(df$trial_id))
{
df$SE[df$trial_id==i]<-sqrt((df$prop[df$trial_id==i] * (1-df$prop[df$trial_id==i])) / sum(df$n[df$trial_id==i]))
}
df$Actual[is.na(df$Actual)] <- FALSE
saveRDS(df, file = "../model_data/fitforplot16mpn.RDS")
write.csv(df, '../model_data/fitforplot16mpn.csv')
rm(list=ls())
# Sometims just for running
df <- readRDS("../model_data/fitforplot16mpn.RDS")
# Define plotting function
plot_nomodel_pgroup <- function(pgroup_label, df) {
df_filtered <- df %>% filter(pgroup == pgroup_label)
ggplot(df_filtered, aes(x = node3, y = prop, fill = Observed, colour = Actual)) +
geom_bar(stat = 'identity') +
geom_errorbar(aes(ymin = prop-SE, ymax = prop+SE), width = .2) +
labs(
x = 'Response',
y = 'Proportion/',
title = sprintf("Particpant responses at %s", pgroup_label)
) +
scale_fill_brewer(palette = "Set2") + # , labels = c("Observed \n(A|B)", "Unobserved \n(Au|Bu)")
scale_colour_manual(values = c('gray', 'black')) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
#geom_point(aes(y = .data[[model_colname]]), colour = 'black') +
geom_rect(
data = subset(df_filtered, trial_structure_type %in% c("Conjunctive: A=1,B=1,E=1", "Disjunctive: A=1,B=1,E=1")),
fill = NA, colour = "blue", xmin = -Inf, xmax = Inf, linewidth = 2,
ymin = -Inf, ymax = Inf
) +
facet_wrap(~trial_structure_type, ncol = 6) +
theme_bw() +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.margin = margin(c(0, 0, 0, 0)),
axis.title.x = element_text(margin = margin(t = 1, r = 0, b = 0, l = 0)),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
}
plot3 <- plot_nomodel_pgroup('A=.1,Au=.7,B=.8,Bu=.5', df)
print(plot3)
plotname <- paste0("../figs/forN3.pdf")
ggsave(plotname, plot = plot3)
ggsave(plotname, plot = plot3, width = 12)
# Define plotting function
plot_nomodel_pgroup <- function(pgroup_label, df) {
df_filtered <- df %>% filter(pgroup == pgroup_label)
ggplot(df_filtered, aes(x = node3, y = prop, fill = Observed, colour = Actual)) +
geom_bar(stat = 'identity') +
geom_errorbar(aes(ymin = prop-SE, ymax = prop+SE), width = .2) +
labs(
x = 'Response',
y = 'Proportion',
title = sprintf("Participant responses at %s", pgroup_label)
) +
scale_fill_brewer(palette = "Set2") + # , labels = c("Observed \n(A|B)", "Unobserved \n(Au|Bu)")
scale_colour_manual(values = c('gray', 'black')) +
guides(fill = guide_legend(override.aes = list(shape = NA))) +
#geom_point(aes(y = .data[[model_colname]]), colour = 'black') +
geom_rect(
data = subset(df_filtered, trial_structure_type %in% c("Conjunctive: A=1,B=1,E=1", "Disjunctive: A=1,B=1,E=1")),
fill = NA, colour = "blue", xmin = -Inf, xmax = Inf, linewidth = 2,
ymin = -Inf, ymax = Inf
) +
facet_wrap(~trial_structure_type, ncol = 6) +
theme_bw() +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.margin = margin(c(0, 0, 0, 0)),
axis.title.x = element_text(margin = margin(t = 1, r = 0, b = 0, l = 0)),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
}
plot3 <- plot_nomodel_pgroup('A=.1,Au=.7,B=.8,Bu=.5', df)
print(plot3)
plotname <- paste0("../figs/forN3.pdf")
ggsave(plotname, plot = plot3, width = 12)
plot1 <- plot_nomodel_pgroup("A=.1,Au=.5,B=.8,Bu=.5", df)
plot2 <- plot_nomodel_pgroup("A=.5,Au=.1,B=.5,Bu=.8", df)
plot3 <- plot_nomodel_pgroup('A=.1,Au=.7,B=.8,Bu=.5', df)
p1 <- paste0("../figs/forN1.pdf")
ggsave(p1, plot = plot1, width = 12)
p2 <- paste0("../figs/forN2.pdf")
ggsave(p2, plot = plot2, width = 12)
p3 <- paste0("../figs/forN3.pdf")
ggsave(p3, plot = plot3, width = 12)
# A different function to compare two models on one plot
plot_two_models_pgroup <- function(model1, model2, pgroup_label, df) {
df_filtered <- df %>% filter(pgroup == pgroup_label)
ggplot(df_filtered, aes(x = node3, y = prop, fill = Observed, colour = Actual)) +
geom_bar(stat = 'identity') +
geom_errorbar(aes(ymin = prop-SE, ymax = prop+SE), width = .2) +
# Model 1: black circles
geom_point(aes(y = .data[[model1]]),
colour = 'black',
shape = 16,
size = 2,
alpha = 0.9,
show.legend = TRUE) +
# Model 2: red triangles
geom_point(aes(y = .data[[model2]]),
colour = 'red',
shape = 17,
size = 2,
alpha = 0.9,
show.legend = TRUE) +
geom_rect(
data = subset(df_filtered, trial_structure_type %in% c("Conjunctive: A=1,B=1,E=1", "Disjunctive: A=1,B=1,E=1")),
fill = NA, colour = "blue", xmin = -Inf, xmax = Inf, linewidth = 2,
ymin = -Inf, ymax = Inf
) +
facet_wrap(~trial_structure_type, ncol = 6) +
labs(
x = 'Response',
y = 'Proportion/Prediction',
title = sprintf("Models %s (black) & %s (red) at  %s", model1, model2, pgroup_label)
) +
scale_fill_brewer(palette = "Set2") + #, labels = c("Observed \n(A|B)", "Unobserved \n(Au|Bu)")) +
scale_colour_manual(values = c('gray', 'black')) +
theme_bw() +
theme(
panel.grid = element_blank(),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.margin = margin(c(0, 0, 0, 0)),
axis.title.x = element_text(margin = margin(t = 1, r = 0, b = 0, l = 0)),
plot.title = element_text(size = 18, face = "bold", hjust = 0.5)
)
}
# For example, to compare 'full' and 'noSelect' for a given pgroup:
p4 <- plot_two_models_pgroup('full', 'noSelect', 'A=.1,Au=.5,B=.8,Bu=.5', df) #1
p5 <- plot_two_models_pgroup('full', 'noSelect', 'A=.5,Au=.1,B=.5,Bu=.8', df) #2
p6 <- plot_two_models_pgroup('full', 'noSelect', 'A=.1,Au=.7,B=.8,Bu=.5', df) #3
pc1 <- paste0("../figs/comparefullns1.pdf")
ggsave(pc1, plot = p4, width = 12)
pc2 <- paste0("../figs/comparefullns2.pdf")
ggsave(pc2, plot = p5, width = 12)
pc3 <- paste0("../figs/comparefullns3.pdf")
ggsave(pc3, plot = p6, width = 12)
